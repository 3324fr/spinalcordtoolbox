
[1;32mSubject: errsm_23[0m
[1;31mContrast: t2[0m

==============================================================================================
Down sampling files
==============================================================================================
==============================================================================================
Multiply voxels intensity
==============================================================================================
==============================================================================================
sct_register_to_template.py
        -i ../../data/errsm_23/t2/t2.nii.gz
        -l ../../data/errsm_23/t2/t2_landmarks_C2_T2_center.nii.gz
        -m ../../data/errsm_23/t2/t2_segmentation_PropSeg.nii.gz
        -r 0
	-s superfast
	-o 1
	-t 1
==============================================================================================

*** WARNING: DEBUG MODE ON ***


Check parameters:
.. Data:                 ../../data/errsm_23/t2/t2.nii.gz
.. Landmarks:            ../../data/errsm_23/t2/t2_landmarks_C2_T2_center.nii.gz
.. Segmentation:         ../../data/errsm_23/t2/t2_segmentation_PropSeg.nii.gz
.. Output type:          1
.. Speed:                superfast
.. Remove temp files:    0

Assign number of iterations based on speed...
.. 3x1

Check existence of input files...
  OK: ../../data/errsm_23/t2/t2.nii.gz
  OK: ../../data/errsm_23/t2/t2_landmarks_C2_T2_center.nii.gz
  OK: ../../data/errsm_23/t2/t2_segmentation_PropSeg.nii.gz

Create temporary folder...
>> mkdir tmp.140828154345

Copy files...
>> c3d ../../data/errsm_23/t2/t2.nii.gz -o tmp.140828154345/data.nii
>> c3d ../../data/errsm_23/t2/t2_landmarks_C2_T2_center.nii.gz -o tmp.140828154345/landmarks.nii.gz
>> c3d ../../data/errsm_23/t2/t2_segmentation_PropSeg.nii.gz -o tmp.140828154345/segmentation.nii.gz

Change orientation of input images to RPI...
>> sct_orientation -i data.nii -o data_rpi.nii -orientation RPI
>> sct_orientation -i landmarks.nii.gz -o landmarks_rpi.nii.gz -orientation RPI
>> sct_orientation -i segmentation.nii.gz -o segmentation_rpi.nii.gz -orientation RPI

Straighten the spinal cord using centerline/segmentation...
>> sct_straighten_spinalcord.py -i data_rpi.nii -c segmentation_rpi.nii.gz -r 0

Apply straightening to segmentation...
>> WarpImageMultiTransform 3 segmentation_rpi.nii.gz segmentation_rpi_straight.nii.gz -R data_rpi_straight.nii warp_curve2straight.nii.gz

Smoothing along centerline to improve accuracy and remove step effects...
>> c3d data_rpi_straight.nii -smooth 0x0x5vox -o data_rpi_straight.nii
>> c3d segmentation_rpi_straight.nii.gz -smooth 0x0x5vox -o segmentation_rpi_straight.nii.gz

Remove unused label on template. Keep only label present in the input label image...
>> sct_label_utils.py -t remove -i /home/django/aroux/code/spinalcordtoolbox/testing/data/landmarks_center.nii.gz -o template_label.nii.gz -r landmarks_rpi.nii.gz

Create a 5 mm cross for the template labels...
>> sct_label_utils.py -t cross -i template_label.nii.gz -o template_label_cross.nii.gz -c 5

Create a 5mm cross for the input labels and dilate for straightening preparation...
>> sct_label_utils.py -t cross -i landmarks_rpi.nii.gz -o landmarks_rpi_cross3x3.nii.gz -c 5 -d

Push the input labels to the straight space...
>> WarpImageMultiTransform 3 landmarks_rpi_cross3x3.nii.gz landmarks_rpi_cross3x3_straight.nii.gz -R data_rpi_straight.nii warp_curve2straight.nii.gz --use-NN

Convert landmarks from FLOAT32 to INT...
>> c3d landmarks_rpi_cross3x3_straight.nii.gz -type int -o landmarks_rpi_cross3x3_straight.nii.gz

Estimate affine transfo: straight anat --> template (landmark-based)...
>> ANTSUseLandmarkImagesToGetAffineTransform template_label_cross.nii.gz landmarks_rpi_cross3x3_straight.nii.gz affine straight2templateAffine.txt

ERROR!!! 
 fix-label 21 movlabel 21
 fix-label 22 movlabel 22
 fix-label 23 movlabel 23
 fix-label 24 movlabel 24
 point [-1.25, -4.75, -75.25]
 point [2.75, -0.75, -75.25]
 point [-1.25, 5.25, -75.25]
 point [-7.25, -0.75, -75.25]
  Fixed Landmark: [-1.25, -4.75, -75.25] Moving landmark [-0.00963211, -14.7384, 52.0639]
  Fixed Landmark: [2.75, -0.75, -75.25] Moving landmark [4.99037, -9.73842, 51.0639]
  Fixed Landmark: [-1.25, 5.25, -75.25] Moving landmark [-0.00963211, -4.73842, 50.7305]
  Fixed Landmark: [-7.25, -0.75, -75.25] Moving landmark [-5.00963, -9.73842, 51.0639]
  Fixed Landmark: [1.73061e-77, 1.28823e-231, 1.31002e-231] Moving landmark [-0.00963211, -13.7384, -65.0472]
  Fixed Landmark: [2.82478e-309, 1.28823e-231, 6.94943e-310] Moving landmark [4.49037, -8.73842, -66.1028]
  Fixed Landmark: [6.94943e-310, 6.94943e-310, 6.94943e-310] Moving landmark [-0.00963211, -3.73842, -66.9361]
  Fixed Landmark: [6.94943e-310, 1.28823e-231, 6.94943e-310] Moving landmark [-5.50963, -8.73842, -65.7695]
libc++abi.dylib: terminate called throwing an exception
sh: line 1: 42222 Abort trap: 6           ANTSUseLandmarkImagesToGetAffineTransform template_label_cross.nii.gz landmarks_rpi_cross3x3_straight.nii.gz affine straight2templateAffine.txt
Exit program.

==============================================================================================
WarpImageMultiTransform
        3
        /home/django/aroux/code/spinalcordtoolbox/data/template/MNI-Poly-AMU_cord.nii.gz
        templatecord2anat.nii.gz
        -R ../../data/errsm_23/t2/t2.nii.gz 
        warp_template2anat.nii.gz
        --use-NN
==============================================================================================
FIELD: warp_template2anat.nii.gz
moving_image_filename: /home/django/aroux/code/spinalcordtoolbox/data/template/MNI-Poly-AMU_cord.nii.gz components 1
output_image_filename: templatecord2anat.nii.gz
reference_image_filename: ../../data/errsm_23/t2/t2.nii.gz
[0/1]: FIELD: warp_template2anat.nii.gz
User nearest neighbor interpolation (was Haha) 
Exception caught during WarpImageMultiTransform.

itk::ImageFileReaderException (0x7fe91c912238)
Location: "unknown" 
File: /home/django/jcohen2/antsbin/ITKv4-install/include/ITK-4.5/itkImageFileReader.hxx
Line: 143
Description:  Could not create IO object for file warp_template2anat.nii.gz
The file doesn't exist. 
Filename = warp_template2anat.nii.gz



==============================================================================================
sct_dice_coefficient
        ../../data/errsm_23/t2/t2_manual_segmentation.nii.gz
        templatecord2anat.nii.gz
        -bmax
==============================================================================================
libc++abi.dylib: terminate called throwing an exception
./test_sct_register_to_template.sh: line 35: 42237 Abort trap: 6           $cmd
==============================================================================================
sct_dice_coefficient
        ../../data/errsm_23/t2/t2_manual_segmentation.nii.gz
        templatecord2anat.nii.gz
        -bmax
==============================================================================================
